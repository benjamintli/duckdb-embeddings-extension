# name: test/sql/embeddings.test
# description: test quack extension
# group: [embeddings]

# Before we load the extension, this will fail
statement error
SELECT embeddings('model_name', 'Sam');
----
Catalog Error: Scalar Function with name embeddings does not exist!
Did you mean "median"?

# Require statement will ensure this test is run with this extension loaded
require embeddings

# Require statement will ensure the extension is loaded from now on
statement ok
CREATE TABLE people(name TEXT, age INT);

statement ok
INSERT INTO people VALUES ('frjekfnr', 18), ('Bob', 199), ('Yiran', 101010);

# Confirm the extension works
query I
SELECT array_length(embeddings('sentence-transformers/all-MiniLM-L6-v2', name)) from people
----
384
384
384

query I
SELECT array_length(embeddings('BAAI/bge-large-en-v1.5', name)) from people
----
1024
1024
1024

statement error
SELECT embeddings(name, name) from people
----
Invalid type Error: model name is not a constant string!